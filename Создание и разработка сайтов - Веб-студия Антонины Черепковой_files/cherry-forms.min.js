var CherryForms={Settings:{SaveUtmForDays:31,UrlServerApi:"http://"+location.host+"/api/Forms.Submit",ArrayEnable:{0:!0,1:!0,2:!0,3:!0},SuccessMessage:!0},StartTime:0,QueryStringArray:{},GetCookie:function(r){var e=document.cookie.match(new RegExp("(?:^|; )"+r.replace(/([\.$?*|{}\(\)\[\]\\/\+^])/g,"$")+"=([^;]*)"));return e?decodeURIComponent(e[1]):void 0},Initialization:function(r){if((void 0!=r&&1==r||void 0==r)&&(CherryForms.StartTime=Math.ceil((new Date).getTime()/1e3),window.location.search.substr(1).split("&").forEach(function(r){r=r.split("="),CherryForms.QueryStringArray[r[0]]=r[1]}),null!=CherryForms.QueryStringArray.utm_source)){console.log("Detected UTM Query. UTM Saved for "+CherryForms.Settings.SaveUtmForDays+" days.");var e=new Date((new Date).getTime()+864e5*CherryForms.Settings.SaveUtmForDays);document.cookie="utm_source="+decodeURIComponent(CherryForms.QueryStringArray.utm_source)+"; path=/; expires="+e.toUTCString(),document.cookie="utm_medium="+decodeURIComponent(CherryForms.QueryStringArray.utm_medium)+"; path=/; expires="+e.toUTCString(),document.cookie="utm_campaign="+decodeURIComponent(CherryForms.QueryStringArray.utm_campaign)+"; path=/; expires="+e.toUTCString(),document.cookie="utm_content="+decodeURIComponent(CherryForms.QueryStringArray.utm_content)+"; path=/; expires="+e.toUTCString(),document.cookie="pm_position="+decodeURIComponent(CherryForms.QueryStringArray.pm_position)+"; path=/; expires="+e.toUTCString(),document.cookie="pm_block="+decodeURIComponent(CherryForms.QueryStringArray.pm_block)+"; path=/; expires="+e.toUTCString(),document.cookie="utm_term="+decodeURIComponent(CherryForms.QueryStringArray.utm_term)+"; path=/; expires="+e.toUTCString(),document.cookie="pm_source="+decodeURIComponent(CherryForms.QueryStringArray.pm_source)+"; path=/; expires="+e.toUTCString()}},SubmitedForm:function(r,e){for(;;){if("BODY"==r.prop("tagName")||void 0==r)return;if("FORM"==r.prop("tagName"))break;r=r.parent()}var o=!1,t={},a={},n=r.find("input[type=text], input[type=hidden], input[type=email], textarea");if($.each(n,function(r,e){var o=n.eq(r).attr("name");null!=o&&(t[o]=n.eq(r).val())}),$.each(t,function(e,t){switch(e){case"name":(""==t.replace(" ","")||t.replace(" ","").length<2||!/^[А-Яа-яЁё\s]+$/.test(t))&&(o=!0,CherryForms.ControlError(r.find('*[name="'+e+'"]').eq(0)));break;case"email":CherryForms.IsEmail(t)||(o=!0,CherryForms.ControlError(r.find('*[name="'+e+'"]').eq(0)));break;case"phone":(/[^-+()0-9\s]/.test(t)||""==t.replace(" ","")||t.replace(" ","").length<6)&&(o=!0,CherryForms.ControlError(r.find('*[name="'+e+'"]').eq(0)))}}),!o){if(CherryForms.Settings.ArrayEnable[0]&&(a.array_0={},void 0!==t.name&&(a.array_0.name=t.name),void 0!==t.email&&(a.array_0.email=t.email),void 0!==t.phone&&(a.array_0.phone=t.phone)),CherryForms.Settings.ArrayEnable[1]&&(a.array_1={},$.each(t,function(r,e){"name"!=r&&"email"!=r&&"phone"!=r&&(a.array_1[r]=e)})),CherryForms.Settings.ArrayEnable[2]&&(a.array_2={},void 0!=CherryForms.GetCookie("utm_source")&&(a.array_2.utm_source=CherryForms.GetCookie("utm_source"),a.array_2.utm_medium=CherryForms.GetCookie("utm_medium"),a.array_2.utm_campaign=CherryForms.GetCookie("utm_campaign"),a.array_2.utm_content=CherryForms.GetCookie("utm_content"),a.array_2.pm_position=CherryForms.GetCookie("pm_position"),a.array_2.pm_block=CherryForms.GetCookie("pm_block"),a.array_2.utm_term=CherryForms.GetCookie("utm_term"),a.array_2.pm_source=CherryForms.GetCookie("pm_source"))),CherryForms.Settings.ArrayEnable[3]){a.array_3={},a.array_3.host=location.host,a.array_3.pathname=location.pathname,void 0!=r.attr("data-name")&&(a.array_3.formname=r.attr("data-name"));var i=CherryForms.GetSessionTime();a.array_3.session=i[1]+" минут, "+i[0]+" секунд"}$.post(CherryForms.Settings.UrlServerApi,a,function(o){console.log("From submited, server response:"),console.log(o),CherryForms.Settings.SuccessMessage&&(r.fadeOut("fast",function(){r.html('<div class="alert">Успешно отправлено.</div>'),r.fadeIn()}),void 0!==e&&e(o))})}},ControlError:function(r){r.attr("style","background-color: rgb(250, 0, 0);");var e=0,o=setInterval(function(){e+=5,r.attr("style","background-color: rgb(250, "+e+", "+e+");"),e>=255&&clearInterval(o)},20)},IsEmail:function(r){return new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i).test(r)},GetSessionTime:function(){function r(r){return(r=Math.floor(r))<10?"0"+r:r}var e=Math.ceil((new Date).getTime()/1e3)-CherryForms.StartTime,o=e/3600%24,t=e/60%60;return[r(e%60),r(t),r(o)]}};CherryForms.Initialization(!0);